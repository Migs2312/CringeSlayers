<!DOCTYPE >
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cringe Slayers</title>
    <link rel="stylesheet" href="style.css">
	<link rel="icon" href="./image/icon.png">
	<link rel="manifest" href="./manifest.json">
	<script>
		if ('serviceWorker' in navigator) {
			navigator.serviceWorker.register('./sw.js')
				.then(function () { console.log('service worker registered'); })
				.catch(function () { console.log('service worker failed'); });
		}
	</script>
    </head>
	<body>
		<div class ="whole">
		<div class="fundo" id="fundo">
		<div id="div2" class="cumida winner" >
		</div>
		<div id="div1" class="">
		</div>
		<div class="winner" id="winner">YOU WON!<br>CONGRATS!!!</div>
		<div class="winner" id="loser">YOU LOST!</div>
		<button type="button"  id="start" class="">Start</button>
		<div id="inst" class="">Destroy 1000 cringes before the time runs out!</div>
		<button type="button"  id="cor" class="character">Choose Character</button>
		<div id="inst2" class="winner">Would you like to play again?</div><br>
		<button type="button"  id="repeat" class="winner">YES</button>
		<button type="button"  id="norepeat" class="winner">NO</button>
		<div id = "records" class="winner">High Scores:</div><br>
		<div id = "rec1" class="winner"></div>
		<div id = "rec2" class="winner"></div>
		<div id = "rec3" class="winner"></div>
	</div>
	<div class="painel">
		<div class="pontos1">Points: </div>
		<div class="pontos">0</div>
		<div class="time1">Time:</div>
		<div id="time">0</div>
			<hr>
			<button type="button"  id="acima" class="direct">⬆</button><br>
			<button type="button"  id="esquerda" class="direct">⬅</button>
			<button type="button"  id="direita" class="direct">➡</button><br>
			<button type="button"  id="baixo" class="direct">⬇</button>
	</div>
	</div>
		<script>

			//Alterar pontuação e tempo:
			function updateText (element, string) {
				element.innerHTML = string.toString();
			}
			//Alterar pontuação e tempo

            
			//Mover o personagem:
			function move(Direcao) {
				if (contador != 0) {
					para();
				}
				if (Direcao == "direita") {
					timer = setInterval("direita()",0.1);
					contador ++;
				}

				if (Direcao == "esquerda") {
					timer = setInterval("esquerda()",0.1);
					contador ++;
				}

				if (Direcao == "acima") {
					timer = setInterval("acima()",0.1);
					contador ++;
				}

				if (Direcao == "baixo") {
					timer = setInterval("baixo()",0.1);
					contador ++;
				}
			}
			function direita() {
				let div1Left= parseInt(getComputedStyle(div1).left);
				let fundoWidth= parseInt(getComputedStyle(fundo).width);
				let div1Width= parseInt(getComputedStyle(div1).width);

				div1.style.left = div1Left+7;
				if ( div1Left >= fundoWidth  - div1Width-7){
					clearInterval(timer);
					timer = setInterval ("esquerda()",45);
				}
			}
			function esquerda() {
				let div1Left= parseInt(getComputedStyle(div1).left);
				
				div1.style.left = div1Left-7;
				if ( div1Left <= 20){
					clearInterval(timer);
					timer = setInterval ("direita()",45);
				}
			}
			function baixo() {
				let div1Top= parseInt(getComputedStyle(div1).top);
				let fundoHeight= parseInt(getComputedStyle(fundo).height);
				let div1Height= parseInt(getComputedStyle(div1).height);

				div1.style.top = div1Top+7;
				if(div1Top >= fundoHeight - div1Height-10){
					clearInterval(timer);
				timer = setInterval("acima()",45);
			    }
			}
			function acima() {
				let div1Top= parseInt(getComputedStyle(div1).top);

				div1.style.top = div1Top-7;
				if(div1Top <= 20 ){
				clearInterval(timer);
				timer = setInterval("baixo()",45);
				}
			}
			function para() {
				clearInterval(timer);
			}
			//Mover o personagem
			
			
			//Mudar o personagem e a música:
			let waternoose = 0
			function cor(){
				waternoose = (Math.ceil(Math.random()*1000));
				if(waternoose!=1){
			if(cont == 0){
				wmt.pause();
				wmt.currentTime=0;
				mt.pause();
				mt.currentTime=0;
				div1.style.backgroundImage="url(./image/monsoon.jpeg)";
				mt1.play();
				cont++;
			}else{
				if(cont == 1){
					wmt.pause();
				wmt.currentTime=0;
					mt1.pause();
					mt1.currentTime=0;
					div1.style.backgroundImage="url(./image/sam.jpeg)";
					mt2.play();
					cont++;
		   	    }else{
		   	    if(cont == 2){
					wmt.pause();
				wmt.currentTime=0;
				div1.style.backgroundImage="url(./image/ArmstrongPortrait.webp)";
					mt2.pause();
					mt2.currentTime=0;
                    mt.play();
				    cont = 0;
		        	}
		        }
			}
		}
			if(waternoose==1){
					div1.style.backgroundImage="url(./image/waternoose.jpeg)";
					mt.pause();
				mt.currentTime=0;
				mt1.pause();
					mt1.currentTime=0;
				mt2.pause();
					mt2.currentTime=0;
					wmt.play();
					cont=2;
				}
				return waternoose;
		    }
			//Mudar o personagem e a música


			//Coleta de pontos e Vitória:
			function eat(){
				if(pontuacao<999){
					kill.play();
				if(kill.currentTime>0){
				kill.currentTime=0;
				}
				let wate = waternoose;
					let lef = Math.ceil(Math.random()*30)+"vw";
					let to = Math.ceil(Math.random()*60)+"vw";
					let cringe = Math.ceil(Math.random()*4);
					document.querySelector("#div2").remove();
					const food = document.createElement("div");
					document.querySelector(".fundo").appendChild(food);
					food.className = "cumida";
					food.id="div2";
					if (wate!=1){
					if(cringe==4){
						div2.style.backgroundImage = "url(./image/c4.jpeg)";
					}
					if(cringe==1){
						div2.style.backgroundImage = "url(./image/c1.jpeg)";
					}
					if(cringe==2){
						div2.style.backgroundImage = "url(./image/c2.jpeg)";
					}
					if(cringe==3){
						div2.style.backgroundImage = "url(./image/c3.jpeg)";
					}
					}
					if (wate==1){
						if(cringe==4){
						div2.style.backgroundImage = "url(./image/k4.jpeg)";
					}
					if(cringe==1){
						div2.style.backgroundImage = "url(./image/k1.jpeg)";
					}
					if(cringe==2){
						div2.style.backgroundImage = "url(./image/k2.jpeg)";
					}
					if(cringe==3){
						div2.style.backgroundImage = "url(./image/k3.jpeg)";
					}
					}
					div2.style.top = lef;
					div2.style.left = to;
					pontuacao++;
					updateText(pnts, pontuacao);
					}
					else{
						win.className="";
						div1.className = "winner";
						div2.className = "winner";
						document.querySelector("#records").className = "";
						document.querySelector("#rec1").className = "";
						document.querySelector("#rec2").className = "";
						document.querySelector("#rec3").className = "";
						pontuacao=1000;
						updateText(pnts, pontuacao);
						mt.pause();
						mt1.pause();
						mt2.pause();
						wmt.pause();
						winnerson.play();
						if(waternoose!=1){
						if(cont==0){
						document.querySelector(".fundo").style.backgroundImage = "url(./image/winner.jpeg)"
						document.querySelector(".fundo").style.backgroundSize = "cover"
						}
						if(cont==1){
						document.querySelector(".fundo").style.backgroundImage = "url(./image/winner1.jpeg)"
						document.querySelector(".fundo").style.backgroundSize = "cover"
						}
						if(cont==2){
						document.querySelector(".fundo").style.backgroundImage = "url(./image/winner2.jpeg)"
						document.querySelector(".fundo").style.backgroundSize = "cover"
						}
						}
						else{
							document.querySelector(".fundo").style.backgroundImage = "url(./image/winnerw.jpeg)"
						}
						document.querySelector("#repeat").classList.remove("winner");
						document.querySelector("#norepeat").classList.remove("winner");
						document.querySelector("#inst2").classList.remove("winner");
						clearInterval(end);
						clearInterval(n);
						record();
					}
				}
				function colisao(){
				let div1Left= parseInt(getComputedStyle(div1).left);
				let div1Top= parseInt(getComputedStyle(div1).top);
				let div1Height= parseInt(getComputedStyle(div1).height);
				let div1Width= parseInt(getComputedStyle(div1).width);

				let div2Left= parseInt(getComputedStyle(div2).left);
				let div2Top= parseInt(getComputedStyle(div2).top);
				let div2Height= parseInt(getComputedStyle(div2).height);
				let div2Width= parseInt(getComputedStyle(div2).width);
				
				let fundoHeight= parseInt(getComputedStyle(fundo).height);
				let fundoWidth= parseInt(getComputedStyle(fundo).width);
				
					if (((div1Left >= div2Left)&&(div1Left <= div2Left + div2Width))&&
						((div1Top >= div2Top)&&(div1Top <= div2Top + div2Height))){
							eat();
					}
					if (((div2Left >= div1Left)&&(div2Left <= div1Left + div1Width))&&
						((div2Top >= div1Top)&&(div2Top <= div1Top + div1Height))){
							eat();
					}
				}
				//Coleta de pontos e Vitória


				//Começo, Derrota e Recomeço:
				function start(){
					document.querySelector("#start").className="winner";
					document.querySelector("#inst").className="winner";
					document.querySelector("#cor").className="winner";
					document.querySelector("#records").className="";
					document.querySelector("#rec1").className="";
					document.querySelector("#rec2").className="";
					document.querySelector("#rec3").className="";
					div1.classList.remove("winner");
					div2.classList.remove("winner");
					end = setInterval("finish(end)",1000);
					document.querySelector(".fundo").style.backgroundImage = "";
					sadstreamsam.pause();
					sadstreamsam.currentTime=0;
					winnerson.pause();
					winnerson.currentTime=1;
					document.querySelector("#repeat").className="winner";
					document.querySelector("#norepeat").className="winner";
					div1.className = "";
					div2.className = "";
					lose.className="winner";
					document.querySelector("#inst2").className="winner";
					let n = setInterval("colisao()", 10);
					tempo=60*10;
					pontuacao=0;
					updateText(pnts, pontuacao);
					if(waternoose!=1){
					if(cont==0){
						div1.style.backgroundImage="url(./image/ArmstrongPortrait.webp)";
						mt.currentTime=0;
						mt.play();
					}
					if(cont==1){
						div1.style.backgroundImage="url(./image/monsoon.jpeg)";
						mt1.currentTime=0;
						mt1.play();
					}
					if(cont==2){
						div1.style.backgroundImage="url(./image/sam.jpeg)";
						mt2.currentTime=0;
						mt2.play();
					}
				}
				else{
					div1.style.backgroundImage="url(./image/waternoose.jpeg)";
					wmt.currentTime=0;
					wmt.play();
				}
				}
				function finish(intervalo) {
					tempo--;
					if (tempo == 0) {
						lose.className="";
						div1.className = "winner";
						div2.className = "winner";
						clearInterval(n);
						clearInterval(intervalo);
						if(waternoose!=1){
						if(cont==0){
						document.querySelector(".fundo").style.backgroundImage = "url(./image/loser.png)"
						}
						if(cont==2){
						document.querySelector(".fundo").style.backgroundImage = "url(./image/loser1.jpeg)"
						}
						if(cont==1){
						document.querySelector(".fundo").style.backgroundImage = "url(./image/loser2.jpg)"
						}
						}
						else{
							document.querySelector(".fundo").style.backgroundImage = "url(./image/loserw.webp)"
						}
						mt.pause();
						mt1.pause();
						mt2.pause();
						wmt.pause();
						sadstreamsam.play();
						document.querySelector("#repeat").classList.remove("winner");
						document.querySelector("#norepeat").classList.remove("winner");
						document.querySelector("#inst2").classList.remove("winner");
						document.querySelector("#records").className = "";
						document.querySelector("#rec1").className = "";
						document.querySelector("#rec2").className = "";
						document.querySelector("#rec3").className = "";
						para();
						record();
					}
					updateText(tempohtml, tempo.toString());
				}

				function record(){
				if(!localStorage.getItem("rec1")){
						re1 = localStorage.setItem("rec1", (pontuacao));
					}
					else{
						if(pontuacao > localStorage.getItem("rec1")){
							re3 = localStorage.setItem("rec3",localStorage.getItem("rec2"));
							re2 = localStorage.setItem("rec2",localStorage.getItem("rec1"));
							re1 = localStorage.setItem("rec1", (pontuacao));
						}
					}
					if(!localStorage.getItem("rec2")){
						re2 = localStorage.setItem("rec2", (pontuacao));
					}
					else{
						if(pontuacao > localStorage.getItem("rec2")&&pontuacao < localStorage.getItem("rec1")){
							re3 = localStorage.setItem("rec3",localStorage.getItem("rec2"));	
							re2 = localStorage.setItem("rec2",(pontuacao));
							};
						}
					if(!localStorage.getItem("rec3")){
						re3 = localStorage.setItem("rec3", (pontuacao));
					}else{
						if(pontuacao > localStorage.getItem("rec3")&&pontuacao < localStorage.getItem("rec2")){
							re3 = localStorage.setItem("rec3",(pontuacao));
							};
						}
					document.querySelector("#rec1").innerHTML = localStorage.getItem("rec1");
					document.querySelector("#rec2").innerHTML = localStorage.getItem("rec2");
					document.querySelector("#rec3").innerHTML = localStorage.getItem("rec3");
				}


				function repeat(){
					start()
				}
				function menu(){
					document.querySelector(".fundo").style.backgroundImage = "";
					document.querySelector("#start").className="";
					document.querySelector("#inst").className="";
					document.querySelector("#records").className="";
					document.querySelector("#rec1").className="";
					document.querySelector("#rec2").className="";
					document.querySelector("#rec3").className="";
					document.querySelector("#cor").className="character";
					document.querySelector("#repeat").className="winner";
					document.querySelector("#norepeat").className="winner";
					document.querySelector("#inst2").className="winner";
					document.querySelector("#records").className = "winner";
					document.querySelector("#rec1").className = "winner";
					document.querySelector("#rec2").className = "winner";
					document.querySelector("#rec3").className = "winner";
					lose.className="winner";
					win.className="winner";
					sadstreamsam.pause();
					winnerson.pause();
					para();
					document.querySelector("#div1").remove();
					const replay = document.createElement("div");
					document.querySelector(".fundo").appendChild(replay);
					replay.className ="";
					replay.id="div1";
					pontuacao=0;
					updateText(pnts, pontuacao);
					tempo=0;
					updateText(tempohtml, tempo.toString());
				}
				//Começo, Derrota e Recomeço


           		//Músicas e sons:
				let mt = new Audio ("./sound/ihtbtw.mp3");
				mt.loop = true;
				let mt1 = new Audio("./sound/soft.mp3");
				mt1.loop = true;
				let mt2 = new Audio("./sound/totikfr.mp3");
				mt2.loop = true;
				let wmt = new Audio("./sound/miwt.mp3");
				wmt.loop = true;
				let kill = new Audio("./sound/death.wav");
				let sadstreamsam = new Audio ("./sound/youloser.mp3")
				sadstreamsam.loop = true;
				let winnerson = new Audio("./sound/youwin.mp3")
				winnerson.loop=true;
				//Músicas e sons
				

			//Variáveis, Constantes e Timers:
			let win = document.querySelector("#winner");
			let lose = document.querySelector("#loser");
			const pnts = document.querySelector(".pontos");
			const rec1 = document.querySelector("#rec1");
			const rec2 = document.querySelector("#rec2");
			const rec3 = document.querySelector("#rec3");
			let pontuacao = 0;
			let contador = 0;
            let cont = 0;
			let n = setInterval("colisao()", 10);
			let tempo = 60 * 10;
			let end;
			let timer = ""
			const tempohtml = document.getElementById("time");
			//Variáveis, Constantes e Timers


			//Controles:
			document.querySelector("#start").addEventListener("click", ()=>{start()});
            document.querySelector("#acima").addEventListener("click", ()=>{move('acima')});
            document.querySelector("#esquerda").addEventListener("click",()=>{ move('esquerda')});
            document.querySelector("#direita").addEventListener("click",()=>{ move('direita')});
            document.querySelector("#baixo").addEventListener("click",()=>{ move('baixo')});
            document.querySelector("#acima").addEventListener("click",()=>{ move('acima')});
			document.addEventListener("keydown", (e)=>{
				if(e.key=="ArrowLeft"){
					move("esquerda")
				}
				if (e.key == "ArrowRight") {
					move("direita")
				}
				if (e.key == "ArrowUp") {
					move("acima")
				}
				if (e.key == "ArrowDown") {
					move("baixo")
				}
			})
            document.querySelector("#cor").addEventListener("click", ()=>{cor()});
			document.querySelector("#repeat").addEventListener("click", ()=>{repeat()});
			document.querySelector("#norepeat").addEventListener("click", ()=>{menu()});
			//Controles


		</script>
	</body>
</html>
